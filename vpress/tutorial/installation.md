# 安装教程

## 系统要求

系统支持: CentOS 7+/Ubuntu 18+/Debian 10+

处理器架构: `linux/386` `linux/amd64` `liunx/v6` `linux/v7` `linux/arm64` `linux/ppc64le` `linux/s390x`

内存要求: ≥1G

## 安装前准备

1. 一台未被墙的**国外VPS**
2. 一个解析到VPS的**二级域名**
3. 开放端口

| 端口   | 描述                          |
|------|-----------------------------|
| 80   | 伪装Web                       |
| 443  | HTTPS/Trojan/Hysteria(UDP)等 |
| 8863 | Caddy转发                     |
| 8888 | Trojan Panel管理后台Web         |
| 9507 | MariaDB                     |
| 6378 | Redis                       |

使用Trojan Panel需开放以下端口: `80` `443` `8863` `8888`，如果节点和Trojan Panel不在一台服务器上，Trojan Panel服务器需要再开放: `9507`
。反之，为了安全起见，不建议开启该端口。

使用节点(数据库版/单机版)需开放以下端口: `80` `443` `8863`

如果使用的服务器控制面板有防火墙设置需要自己在控制面板自行开放以上端口。

## 安装建议

1. 控制面板和节点都推荐部署在**国外服务器**上，否则会由于网络问题使用一键安装脚本会因为远程下载文件超时报错。

2. 以Trojan Panel+节点(数据库版)为例

   建议的安装顺序: 卸载云盾(阿里云服务器) > 安装BBRplus > 安装Trojan Panel控制面板 > 安装节点(数据库版)

   建议在脚本运行中需要手动输入的部分，如果没有特殊需求或者不知道这个选项是干什么的，除数据库密码和Redis密码自定义以外，其他默认即可。

## 一键安装脚本

```shell
source <(curl -L https://github.com/trojanpanel/install-script/raw/main/install_script.sh)
```

## 安装Trojan Panel

1. 请输入Caddy的转发端口(用于申请证书,默认:8863)

   默认即可，除非8863端口被墙。

2. 请输入你的域名(必填)

   输入你提前解析到本机的域名。

3. 请选择设置证书的方式?(1/自动申请和续签证书 2/手动设置证书路径 默认:1/自动申请和续签证书)

   推荐自动申请和续签证书，如果自己有证书或者自动申请和续签证书失败可以选择手动设置证书路径。

4. 请输入你的邮箱(用于申请证书,默认:`123456@qq.com`)

   默认即可，或输入一个合法的邮箱地址，此选项用于申请证书。

5. 请输入证书的.crt文件路径(必填)

   使用.crt文件的绝对路径，例如：`/root/www.google.com.crt`

6. 请输入证书的.key文件路径(必填)

   使用.key文件的绝对路径，例如：`/root/www.google.com.key`

7. 请输入数据库的端口(默认:9507)

   默认即可，除非9507端口被墙。

8. 请输入数据库的用户名(默认:root)

   默认即可，除非有自定义数据库用户的需求。

9. 请输入数据库的密码(必填)

   输入一个较为复杂且你能记得住的密码。

10. 请输入Redis的端口(默认:6378):

默认即可，除非6378端口被墙。

11. 请输入Redis的密码(必填)

输入一个较为复杂且你能记得住的密码。

12. 请输入数据库的IP地址(默认:本地数据库)

如果数据库安装在本机则默认即可，如果数据库安装在其他服务器这里填远程服务器的IP地址。

13. 请输入数据库的端口(默认:本地数据库端口)

如果数据库安装在本机则默认即可，如果数据库安装在其他服务器这里填远程服务器的数据库端口。

14. 请输入数据库的用户名(默认:root)

默认即可，除非有自定义数据库用户的需求。

15. 请输入数据库的密码(必填)

如果数据库安装在本机则填写本机数据库密码，如果数据库安装在其他服务器这里填远程服务器的数据库密码。

16. 请输入Redis的IP地址(默认:本机Redis)

如果Redis安装在本机则默认即可，如果Redis安装在其他服务器这里填远程服务器的IP地址。

17. 请输入Redis的端口(默认:本机Redis端口)

如果Redis安装在本机则默认即可，如果Redis安装在其他服务器这里填远程服务器的Redis端口。

18. 请输入Redis的密码(必填)

如果Redis安装在本机则填写本机Redis密码，如果Redis安装在其他服务器这里填远程服务器的Redis密码。

**提示**

1. 安装结束后，访问**你的域名**如果是一个静态网页，说明已经安装成功。

2. 安装成功后，Trojan Panel管理面板地址: `你的域名:8888`
   系统管理员 默认用户名: `sysadmin` 默认密码: `123456` 请及时登陆管理面板修改密码。

## 安装Trojan-go

**注意:** 如果你使用的是Websocket+CDN的方式，请提前将解析到本机的域名配置好CDN，建议使用国外的CDN厂商。除非服务器IP被墙，否则不建议使用此方式。

1. 请输入Caddy的转发端口(用于申请证书,默认:8863)

   默认即可，除非8863端口被墙。

2. 请输入你的域名(必填)

   输入你提前解析到本机的域名。

3. 请选择设置证书的方式?(1/自动申请和续签证书 2/手动设置证书路径 默认:1/自动申请和续签证书)

   推荐自动申请和续签证书，如果自己有证书或者自动申请和续签证书失败可以选择手动设置证书路径。

4. 请输入你的邮箱(用于申请证书,默认:`123456@qq.com`)

   默认即可，或输入一个合法的邮箱地址，此选项用于申请证书。

5. 请输入证书的.crt文件路径(必填)

   使用.crt文件的绝对路径，例如：`/root/www.google.com.crt`

6. 请输入证书的.key文件路径(必填)

   使用.key文件的绝对路径，例如：`/root/www.google.com.key`

7. 请输入TrojanGO的端口(默认:443)

   默认即可，除非443端口被墙。

8. 请输入数据库的IP地址(默认:本地数据库)

   如果控制面板安装在本机则默认即可，如果控制面板安装在其他服务器这里填远程服务器的IP地址。

9. 请输入数据库的端口(默认:本地数据库端口)

   如果控制面板安装在本机则默认即可，如果控制面板安装在其他服务器这里填远程服务器的数据库端口。

10. 请输入数据库的用户名(默认:root)

默认即可，除非有自定义数据库用户的需求。

11. 请输入数据库的密码(必填)

如果控制面板安装在本机则填写本机数据库密码，如果控制面板安装在其他服务器这里填远程服务器的数据库密码。

12. 是否开启多路复用?(false/关闭 true/开启 默认:true/开启)

多路复用的意义在于降低握手延迟，而不是提升链路速度。相反，它会增加客户端和服务端的CPU和内存消耗，从而可能造成速度下降。如果服务器配置允许，建议开启。

13. 是否开启Websocket?(false/关闭 true/开启 默认:false/关闭)

建议在IP被墙的时候使用Websocket+CDN的方式复活你的VPS，其他情况下不建议开启这个选项。开启这个选项不会改善你的链路速度（甚至有可能下降），也不会提升你的连接安全性。

14. 输入Websocket路径(默认:trojan-panel-websocket-path)

    越长越复杂越好，前提条件是你能记得住，目的是增加gfw的主动探测的难度。

15. 是否启用Shadowsocks AEAD加密?(false/关闭 true/开启 默认:false/关闭)

    如果你使用的是Websocket+CDN的方式，建议开启此选项。因为Websocket传输的流量经过CDN是不加密的，CDN厂商会对流量进行审查，因此我们开启此选项对流量进行加密。开启这个选项将有可能降低传输性能。

16. 输入Shadowsocks AEAD加密方式(默认:1)

    不知道的默认即可。

17. 输入Shadowsocks AEAD加密密码

    输入一个你能记得住且较为复杂的密码。

## 安装Hysteria

**注意：** 目前支持的hysteria协议处于测试阶段，只支持认证不支持流量控制，需要流量控制的请使用trojan-go协议。

1. 请输入Hysteria的模式(默认:1)

   默认即可，除非网络对UDP流量施加限制，则选择2。

2. 请输入Hysteria的端口(默认:443)

   默认即可，除非443端口被墙，该端口类型为UDP，在防火墙放行时需要注意端口类型。

3. 请输入单客户端最大上传速度/Mbps(默认:100)

   建议填写服务器真实的上行带宽。

4. 请输入单客户端最大下载速度/Mbps(默认:100)

   建议填写服务器真实的下行带宽。

5. 请输入Trojan Panel的地址(默认:本机)

   默认即可，除非Hysteria节点和面板不在一台服务器上，此处填写Trojan Panel的域名地址（没有http/https前缀）